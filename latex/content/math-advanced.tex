\section{Fortgeschrittener Formelsatz}

\begin{frame}[fragile]{Displaystil vs.\ Textstil}

  \LaTeX{} besitzt zwei Stile zum darstellen von Formeln
  \begin{description}
    \item[textstyle] Standardmäßig in \lstinline+$...$+. Kleiner, weniger hoch.
    \item[displaystyle] Formeln werden in der vollen Höhe dargestellt, standardmäßig in allen Mathematik-Umgebungen.
  \end{description}

  \begin{CodeExample}{0.70}[Integral]
    \begin{lstlisting}
      $\int_0^1 x^2$

      $\displaystyle\int_0^1 x^2$
    \end{lstlisting}
  \CodeResult
    \strut
    $\int_0^1 x^2$ \\[0.5\baselineskip]
    $\displaystyle\int_0^1 x^2$
  \end{CodeExample}

  \begin{CodeExample}{0.70}[Bruch]
    \begin{lstlisting}
      $\frac{1}{1 + \frac{1}{x^2}}$

      $\displaystyle\frac{1}{1 + \frac{1}{x^2}}$
    \end{lstlisting}
  \CodeResult
    $\frac{1}{1 + \frac{1}{x^2}}$\\[0.5\baselineskip]
    $\displaystyle\frac{1}{1 + \frac{1}{x^2}}$
  \end{CodeExample}
\end{frame}

\begin{frame}[fragile]{%
  Matrizen
  \hfill
  \doc{https://ftp.gwdg.de/pub/ctan/macros/latex/required/amsmath/amsldoc.pdf}{amsmath}
  \doc{http://mirrors.ctan.org/macros/latex/contrib/mathtools/mathtools.pdf}{mathtools}
}
  \begin{CodeExample}{0.70}[Matrizen (und damit Vektoren) werden fett geschrieben.]
    \begin{lstlisting}
      \symbf{M}^\top     \symbf{M}^*
      \symbf{M}^\dagger  \symbf{M}^{-1}  M_{12}
    \end{lstlisting}
  \CodeResult
    \strut
    $\symbf{M}^\top    \quad \symbf{M}^*$ \\
    $\symbf{M}^\dagger \quad \symbf{M}^{-1} \quad M_{12}$
  \end{CodeExample}

  \fontsize{8}{0.8\baselineskip}\selectfont
  \begin{CodeExample}{0.70}[Verschiedene Klammern]
    \begin{lstlisting}
      \begin{pmatrix} \begin{bmatrix} \begin{Bmatrix}
        x & y \\        -1 \\           -1 \\
        z & abc          2               2
      \end{pmatrix}   \end{bmatrix}   \end{Bmatrix}
    \end{lstlisting}
  \CodeResult<valign=center>
    $\displaystyle
      \begin{pmatrix}
        x & y \\
        z & abc
      \end{pmatrix}
      \begin{bmatrix}
        -1 \\
         2
      \end{bmatrix}
      \begin{Bmatrix}
        -1 \\
         2
      \end{Bmatrix}
    $
  \end{CodeExample}
  \begin{CodeExample}{0.60}[Unterschiedliche Ausrichtung mit \lstinline+*+]
    \begin{lstlisting}
      \begin{pmatrix*}[l]     \begin{pmatrix*}[c]
         1 & -1 \\               1 & -1 \\
        -1 &  2                 -1 &  2
      \end{pmatrix*}          \end{pmatrix*}
      \begin{pmatrix*}[r]
         1 & -1 \\
        -1 &  2
      \end{pmatrix*}
    \end{lstlisting}
  \CodeResult
    \begin{CenterStrip}{4}
      $\displaystyle
        \begin{pmatrix*}[l]
           1 & -1 \\
          -1 &  2
        \end{pmatrix*}
        \qquad
        \begin{pmatrix*}[c]
           1 & -1 \\
          -1 &  2
        \end{pmatrix*}
      $
    \end{CenterStrip} \\\nointerlineskip
    \begin{CenterStrip}{4}
      $\displaystyle
        \begin{pmatrix*}[r]
           1 & -1 \\
          -1 &  2
        \end{pmatrix*}
      $
    \end{CenterStrip}
  \end{CodeExample}
  \vspace*{-1pt}
  Mehr Möglichkeiten in der Doku.
\end{frame}

\begin{frame}[fragile]{Unnötigen Leerraum loswerden}
  \lstinline+mathtools+ stellt zwei wichtige Befehle, um Leerraum zu eliminieren:
  \begin{CodeExample}{0.7}[\lstinline+\\mathclap+]
    \begin{lstlisting}
      \lim_{x\to\infty} f(x)

      \lim_{\mathclap{x\to\infty}} f(x)

      \sum_{i \in \{1, 2, 3, 4, 5\}} i

      \sum_{\mathclap{i \in \{1, 2, 3, 4, 5\}}} i
    \end{lstlisting}
  \CodeResult
    \begin{minipage}[t][2\baselineskip][t]{\textwidth}
      $\displaystyle \lim_{x\to\infty} f(x)$
    \end{minipage} \\\nointerlineskip
    \begin{minipage}[t][2\baselineskip][t]{\textwidth}
      $\displaystyle \lim_{\mathclap{x\to\infty}} f(x)$
    \end{minipage} \\\nointerlineskip
    \begin{minipage}[t][2\baselineskip][t]{\textwidth}
      $\displaystyle\sum_{i \in \{1, 2, 3, 4, 5\}} i$
    \end{minipage}\\\nointerlineskip
    \begin{minipage}[t][2\baselineskip][t]{\textwidth}
      $\qquad\displaystyle\sum_{\mathclap{i \in \{1, 2, 3, 4, 5\}}} i$
    \end{minipage}
  \end{CodeExample}

  \begin{CodeExample}{0.7}[\lstinline+\\cramped+]
    \begin{lstlisting}
      2^{2^2} \cramped{2^{2^2}}
    \end{lstlisting}
  \CodeResult
    \strut
    $2^{2^2} \cramped{2^{2^2}}$
  \end{CodeExample}

\end{frame}

\begin{frame}[fragile]{Fallunterscheidungen}
  \begin{itemize}
    \item Umgebungen mit \lstinline+*+ aktivieren den Textmodus nach dem \lstinline+&+.
    \item Umgebungen mit \lstinline+d+ am Anfang nutzen den Displaystil
  \end{itemize}
  \begin{CodeExample}{0.55}
    \begin{lstlisting}
      f(x) =
      \begin{cases}
         x ,         & x \ge 0 \\
        \int_0^1 x , & \text{sonst}
      \end{cases}

      \begin{drcases*}
         x ,         & $x < 0$ \\
        \int_0^1 x , & sonst
      \end{drcases*}
      \ne - \lvert x \rvert
    \end{lstlisting}
  \CodeResult
    \begin{CenterStrip}{5}
      \centering
      $\displaystyle
        f(x) =
        \begin{cases}
           x ,         & x \ge 0 \\
          \int_0^1 x , & \text{sonst}
        \end{cases}
      $
    \end{CenterStrip}
    \\[\baselineskip]
    \begin{CenterStrip}{5}
      \centering
      $\displaystyle
        \begin{drcases*}
           x ,         & $x < 0$ \\
          \int_0^1 x , & sonst
        \end{drcases*}
        \ne - \lvert x \rvert
      $
    \end{CenterStrip}
  \end{CodeExample}
\end{frame}

\begin{frame}[fragile]{Textausrichtung in \texttt{align}-Umgebung}
  \lstinline+\intertext+ erhält die Ausrichtung der \lstinline+align+-Umgebung.
  \begin{CodeExample}{0.60}
    \begin{lstlisting}
      Es gilt
      \begin{align*}
        f  &= xyz , \\
        \intertext{wobei dies ein langer Erklärungstext ist, und dass}
        g' &= \symup{e}^x \\
        \shortintertext{von}
        g  &= \symup{e}^x
      \end{align*}
      gelöst wird.
    \end{lstlisting}
  \CodeResult
    Es gilt
    \begin{align*}
      f  &= xyz , \\
      \intertext{wobei dies ein langer Erklärungstext ist, und dass}
      g' &= \symup{e}^x \\
      \shortintertext{von}
      g  &= \symup{e}^x
    \end{align*}
    gelöst wird.
  \end{CodeExample}
\end{frame}

\begin{frame}[fragile]{Ergänzende Erklärungen für Formeln}
  \begin{CodeExample}{0.65}
    \begin{lstlisting}
      f(x)=
      \underbrace{g(x)}_{x + x^2 + x^3}
      +
      \overbrace{h(x)}^{\mathclap{\text{mehr Erklärung}}}
      + 2
    \end{lstlisting}
  \CodeResult
    \begin{equation*}
      f(x)= \underbrace{g(x)}_{x + x^2 + x^3}
      + \overbrace{h(x)}^{
        \mathclap{\text{mehr Erklärung}}
      } + 2
    \end{equation*}
  \end{CodeExample}
\end{frame}

\begin{frame}[fragile]{Ausrichtung trotz fehlender Symbole mit \texttt{\backslash phantom}}
  \begin{CodeExample}{0.60}
    \begin{lstlisting}
      \begin{align*}
        f_{123} &=          2  x + 3y + z \\
        g       &= \phantom{2} x + 3y + z \\
        h       &=             x + 3y + z
      \end{align*}
    \end{lstlisting}
  \CodeResult%
  \removedisplayskip
    \begin{align*}
      f_{123} &=          2  x + 3y + z \\
      g       &= \phantom{2} x + 3y + z \\
      h       &=             x + 3y + z
    \end{align*}
  \end{CodeExample}
  \begin{CodeExample}{0.60}
    \begin{lstlisting}
      \begin{align*}
        f &=           \frac{1}{2}  x\\
        g &= \hphantom{\frac{1}{2}} x\\
      \end{align*}
      \begin{align*}
        f &=           \frac{1}{2}  x\\
        g &=  \phantom{\frac{1}{2}} x
      \end{align*}
    \end{lstlisting}
  \CodeResult
    \mathtoolsset{shortvdotsadjustbelow=1.8em}
    \removedisplayskip
    \begin{minipage}[t]{0.5\textwidth}%
    \begin{align*}
      f &=           \frac{1}{2}  x\\
      g &= \hphantom{\frac{1}{2}} x\\
    \end{align*}
    \end{minipage}%
    \begin{minipage}[t]{0.5\textwidth}%
    \begin{align*}
      f &=           \frac{1}{2}  x\\
      g &=  \phantom{\frac{1}{2}} x
    \end{align*}
    \end{minipage}%
  \end{CodeExample}
  \lstinline+\hphantom+ wirkt nur horizontal und hat keine Höhe. \\
\end{frame}

\begin{frame}[fragile]{Ausrichtung vertikaler Umbrüche mit \texttt{\backslash vphantom}}
  \begin{CodeExample}{0.8}
    \begin{lstlisting}
      \begin{align*}
        f = {} & \left( \frac{1}{2} \right. \\
               & \left. \vphantom{\frac{1}{2}} + x \right)^{\!\! 2}
      \end{align*}
    \end{lstlisting}
  \CodeResult
    \removedisplayskip
    \begin{align*}
      f = {} & \left( \frac{1}{2} \right. \\
             & \left. \vphantom{\frac{1}{2}} + x \right)^{\!\! 2}
    \end{align*}
  \end{CodeExample}
  \vspace{5pt}
  \lstinline+\vphantom+ wirkt nur vertikal und hat keine Breite.
\end{frame}
